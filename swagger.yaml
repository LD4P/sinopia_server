swagger: '2.0'
consumes:
  - "application/json+ld"
produces:
  - "application/json+ld"
basePath: /
info:
  description: Sinopia Server. Supports CRUD, following loosely LDP, on Sinopia resources. Top level requires special authorization for creating a group's graph (i.e. PCC, Stanford, etc.).
  version: 1.0.0
  title: Sinopia Server
  license:
    name: Apache 2.0
    url: 'http://www.apache.org/licenses/LICENSE-2.0.html'
securityDefinitions:
  RemoteUser:
    type: apiKey
    in: header
    name: On-Behalf-Of
paths:
  /repository:
    get:
      summary: Get metadata for the base container.
      description: Get the RDF metadata (default serialization is JSON-LD) for the base container.
      operationId: getBase
      tags:
        - LDP
      security:
        - RemoteUser: []
      responses:
        '200':
          description: Successful base container response.
          headers:
            type:
              description: Target URI matching type of container (basic).
              type: string
              format: URI
            Content-Type:
              description: Content-Type for resource
              type: string
              format: URI
          schema:
            $ref: '#/definitions/LDPContainer'
        '404':
          description: Unable to find the base container.
          schema:
            $ref: '#/definitions/ErrorResponse'
        default:
          description: Unsuccessful response
    post:
      summary: Create new Group within the base container.
      description: Create a new Group (defined via JSON-LD in payload) within the base container.
      operationId: createGroup
      tags:
        - LDP
      security:
        - RemoteUser: []
      parameters:
        - name: Slug
          description: The suggested URI path for the group.
          in: header
          required: true
          type: string
        - name: Group
          in: body
          description: Group metadata to insert into base container and describe the group.
          required: true
          schema:
            $ref: '#/definitions/LDPContainer'
        - name: Content-Type
          in: header
          description: Content-Type of Group metadata, with preference for JSON-LD.
          required: false
          type: string
      responses:
        "201":
          description: Successful Group creation.
          headers:
            Location:
              description: URI of the newly created group.
              type: string
              format: uri
        "401":
          description: Unsuccessful authentication.
        "403":
          description: You are not allow to perform this action.
        "404":
          description: Unable to find base container.
        "405":
          description: Method not allowed.
          headers:
            Allow:
              description: HTTP methods allowed
              type: array
              items:
                type: string
        "409":
          description: Group (based on URI and identifier) already exists.
        default:
          description: Unsuccessful response
    put:
      summary: Update metadata on base container.
      description: Update metadata of base container with new metadata defined via JSON-LD in payload. Performs overwrite, not partial update.
      operationId: updateBase
      tags:
        - LDP
      security:
        - RemoteUser: []
      parameters:
        - name: Base
          in: body
          description: New base container metadata to assert on the container.
          required: true
          schema:
            $ref: '#/definitions/Resource'
        - name: Content-Type
          in: header
          description: Content-Type of Group metadata, with preference for JSON-LD.
          required: false
          type: string
      responses:
        "200":
          description: Successful response
        "204":
          description: Base container updated successfully.
          headers:
            Location:
              description: URI of the updated base container.
              type: string
              format: uri
        "401":
          description: Unsuccessful authentication.
        "403":
          description: You are not allow to perform this action.
        "404":
          description: Unable to find the base container.
        "405":
          description: Method not allowed.
          headers:
            Allow:
              description: HTTP methods allowed
              type: array
              items:
                type: string
    options:
      summary: HTTP Options for base container.
      description: Gets the available options for HTTP methods to utilize on the base container.
      operationId: optionsBase
      tags:
        - LDP
      security:
        - RemoteUser: []
      responses:
        "200":
          description: Successful response.
          headers:
            Accept:
              type: array
              items:
                type: string
            Accept-Patch:
              type: array
              items:
                type: string
        "404":
          description: Unable to the find base container.
        default:
          description: Unsuccessful response
    head:
      summary: Get headers only for base container GET request.
      description: Gets the header values that would normally be found in the header of GET request on the base container.
      operationId: headBase
      tags:
        - LDP
      security:
        - RemoteUser: []
      responses:
        "200":
          description: Successful response.
          headers:
            Allow:
              type: array
              items:
                type: string
            Link:
              type: array
              items:
                type: string
                format: uri
        "404":
          description: Unable to find the base container.
        default:
          description: Unsuccessful response
  /repository/{groupID}:
    get:
      summary: Get metadata (RDF) for a given Group.
      description: Get the RDF (default serialization is JSON-LD) for a given Group.
      operationId: getGroup
      tags:
        - LDP
      security:
        - RemoteUser: []
      parameters:
        - name: groupID
          description: The group who is defining it's own resources or graph within Sinopia.
          in: path
          required: true
          type: string
      responses:
        '200':
          description: Successful group container response.
          headers:
            type:
              description: Target URI matching type of container (basic).
              type: string
              format: URI
            Content-Type:
              description: Content-Type for resource
              type: string
              format: URI
          schema:
            $ref: '#/definitions/LDPContainer'
        '404':
          description: Unable to find the specified Group container.
          schema:
            $ref: '#/definitions/ErrorResponse'
        default:
          description: Unsuccessful response
    post:
      summary: Create a resource within a Group.
      description: Create a new resource (defined via JSON-LD in payload) within a supplied Group.
      operationId: createResource
      tags:
        - LDP
      security:
        - RemoteUser: []
      parameters:
        - name: groupID
          description: The group who is defining it's own resources or graph within Sinopia.
          in: path
          required: true
          type: string
        - name: resource
          in: body
          description: Resource to insert into container
          required: true
          schema:
            $ref: '#/definitions/Resource'
        - name: Slug
          in: header
          description: The suggested URI path for the resource.
          required: false
          type: string
          format: URI
        - name: Content-Type
          in: header
          description: Content-Type for the resource, with preference for JSON-LD.
          required: false
          type: string
      responses:
        "201":
          description: Successful creation
          headers:
            Location:
              description: URI of the newly created resoruce.
              type: string
              format: uri
        "401":
          description: Unsuccessful authentication.
        "403":
          description: You are not allow to perform this action.
        "404":
          description: Unable to find either the base or group container.
        "405":
          description: Method not allowed
          headers:
            Allow:
              description: HTTP methods allowed
              type: array
              items:
                type: string
        "409":
          description: Resource URI already exists (if you provide a slug).
        default:
          description: Unsuccessful response
    put:
      summary: Update metadata on a group.
      description: Update metadata of a given group container with new metadata defined via JSON-LD in payload. Performs overwrite, not partial update.
      operationId: updateGroup
      tags:
        - LDP
      security:
        - RemoteUser: []
      parameters:
        - name: groupID
          description: The group who is defining it's own resources or graph within Sinopia. LDP Container to create the new resource within.
          in: path
          required: true
          type: string
        - name: Group
          in: body
          description: Group metadata to replace existing description of the given group.
          required: true
          schema:
            $ref: '#/definitions/LDPContainer'
        - name: Content-Type
          in: header
          description: Content-Type of Group metadata, with preference for JSON-LD.
          required: false
          type: string
      responses:
        "200":
          description: Successful response for Group update.
        "204":
          description: Group updated successfully.
          headers:
            Location:
              description: URI of the updated group.
              type: string
              format: uri
        "401":
          description: Unsuccessful authentication.
        "403":
          description: You are not allow to perform this action.
        "404":
          description: Unable to find either the base or group container.
        "405":
          description: Method not allowed.
          headers:
            Allow:
              description: HTTP methods allowed
              type: array
              items:
                type: string
        default:
          description: Unsuccessful response
    delete:
      summary: Delete an Group.
      description: Deletes an existing Group container. This Group URI cannot be reused.
      operationId: deleteGroup
      tags:
        - LDP
      security:
        - RemoteUser: []
      parameters:
        - name: groupID
          description: The group who is defining it's own resources or graph within Sinopia.
          in: path
          required: true
          type: string
      responses:
        "200":
          description: Successful response for request.
          headers:
            Location:
              description: URI of the deleted group.
              type: string
              format: uri
        "204":
          description: Successfully deleted the provided Group.
        "401":
          description: Unsuccessful authentication.
        "403":
          description: You are not allow to perform this action.
        "404":
          description: Unable to find either the base or group container.
        "405":
          description: Method not allowed.
          headers:
            Allow:
              description: HTTP methods allowed
              type: array
              items:
                type: string
        default:
          description: Unsuccessful response
    options:
      summary: HTTP Options for group.
      description: Gets the available options for HTTP methods to utilize on the given group.
      operationId: optionsGroup
      tags:
        - LDP
      security:
        - RemoteUser: []
      parameters:
        - name: groupID
          description: The group who is defining it's own resources or graph within Sinopia.
          in: path
          required: true
          type: string
      responses:
        "200":
          description: Successful response.
          headers:
            Accept:
              type: array
              items:
                type: string
            Accept-Patch:
              type: array
              items:
                type: string
        "404":
          description: Unable to find the given group.
        default:
          description: Unsuccessful response
    head:
      summary: Get headers only for a group GET request.
      description: Gets the header values that would normally be found in the header of GET request on the given group.
      operationId: headGroup
      tags:
        - LDP
      parameters:
        - name: groupID
          description: The group who is defining it's own resources or graph within Sinopia.
          in: path
          required: true
          type: string
      responses:
        "200":
          description: Successful response.
          headers:
            Allow:
              type: array
              items:
                type: string
            Link:
              type: array
              items:
                type: string
                format: uri
        "404":
          description: Unable to find the given group.
        default:
          description: Unsuccessful response
  /repository/{groupID}/{resourceID}:
    get:
      summary: Get metadata (RDF) for a given resource.
      description: Get the RDF (default serialization is JSON-LD) for a given resource.
      operationId: getResource
      tags:
        - LDP
      security:
        - RemoteUser: []
      parameters:
        - name: groupID
          description: The group who is defining it's own resources or graph within Sinopia.
          in: path
          required: true
          type: string
        - name: resourceID
          description: The UUID for the resource defined and managed within Sinopia.
          in: path
          required: true
          type: string
      responses:
        '200':
          description: Successful resource response.
          headers:
            type:
              description: Target URI matching type of resource.
              type: string
              format: URI
            Content-Type:
              description: Content-Type for resource.
              type: string
              format: URI
          schema:
            $ref: '#/definitions/Resource'
        '404':
          description: Unable to find the specified resource.
          schema:
            $ref: '#/definitions/ErrorResponse'
        default:
          description: Unsuccessful response
    put:
      summary: Update metadata on a resource.
      description: Update metadata of a given resource with new metadata defined via JSON-LD in payload. Performs overwrite, not partial update.
      operationId: updateResource
      tags:
        - LDP
      security:
        - RemoteUser: []
      parameters:
        - name: groupID
          description: The group who is defining it's own resources or graph within Sinopia.
          in: path
          required: true
          type: string
        - name: resourceID
          description: The UUID for the resource defined and managed within Sinopia.
          in: path
          required: true
          type: string
        - name: Resource
          in: body
          description: Resource metadata to replace existing description of the given group.
          required: true
          schema:
            $ref: '#/definitions/Resource'
        - name: Content-Type
          in: header
          description: Content-Type of Group metadata, with preference for JSON-LD.
          required: false
          type: string
      responses:
        "200":
          description: Successful response for Resource update.
        "204":
          description: Resource updated successfully.
          headers:
            Location:
              description: URI of the updated resource.
              type: string
              format: uri
        "401":
          description: Unsuccessful authentication.
        "403":
          description: You are not allow to perform this action.
        "404":
          description: Unable to find the specified resource.
        "405":
          description: Method not allowed.
          headers:
            Allow:
              description: HTTP methods allowed
              type: array
              items:
                type: string
        default:
          description: Unsuccessful response
    delete:
      summary: Delete a Resource.
      description: Deletes an existing Resource. This Resource URI cannot be reused.
      operationId: deleteResource
      tags:
        - LDP
      security:
        - RemoteUser: []
      parameters:
        - name: groupID
          description: The group who is defining it's own resources or graph within Sinopia.
          in: path
          required: true
          type: string
        - name: resourceID
          description: The UUID for the resource defined and managed within Sinopia.
          in: path
          required: true
          type: string
      responses:
        "200":
          description: Successful response for request.
          headers:
            Location:
              description: URI of the deleted resource.
              type: string
              format: uri
        "204":
          description: Successfully deleted the provided resource.
        "401":
          description: Unsuccessful authentication.
        "403":
          description: You are not allow to perform this action.
        "404":
          description: Unable to find the specified resource.
        "405":
          description: Method not allowed.
          headers:
            Allow:
              description: HTTP methods allowed
              type: array
              items:
                type: string
        default:
          description: Unsuccessful response
    options:
      summary: HTTP Options for resource.
      description: Gets the available options for HTTP methods to utilize on the given resource.
      operationId: optionsResource
      tags:
        - LDP
      security:
        - RemoteUser: []
      parameters:
        - name: groupID
          description: The group who is defining it's own resources or graph within Sinopia.
          in: path
          required: true
          type: string
        - name: resourceID
          description: The UUID for the resource defined and managed within Sinopia.
          in: path
          required: true
          type: string
      responses:
        "200":
          description: Successful response.
          headers:
            Accept:
              type: array
              items:
                type: string
            Accept-Patch:
              type: array
              items:
                type: string
        "404":
          description: Unable to find the specified resource.
        default:
          description: Unsuccessful response
    head:
      summary: Get headers only for a resource GET request.
      description: Gets the header values that would normally be found in the header of GET request on the given resource.
      operationId: headResource
      tags:
        - LDP
      parameters:
        - name: groupID
          description: The group who is defining it's own resources or graph within Sinopia.
          in: path
          required: true
          type: string
        - name: resourceID
          description: The UUID for the resource defined and managed within Sinopia.
          in: path
          required: true
          type: string
      responses:
        "200":
          description: Successful response.
          headers:
            Allow:
              type: array
              items:
                type: string
            Link:
              type: array
              items:
                type: string
                format: uri
        "404":
          description: Unable to find the specified resource.
        default:
          description: Unsuccessful response
  /healthcheck:
    get:
      summary: Health Check
      description: The healthcheck endpoint provides information about the health of the service.
      operationId: healthCheck
      responses:
        '200':
          description: The service is functioning nominally
          schema:
            $ref: '#/definitions/HealthCheckResponse'
        '503':
          description: The service is not working correctly
          schema:
            $ref: '#/definitions/HealthCheckResponse'
definitions:
  HealthCheckResponse:
    type: object
    properties:
      status:
        type: string
        description: The status of the service
    example:
      status: OK
  ErrorResponse:
    type: object
    properties:
      errors:
        type: array
        items:
          $ref: '#/definitions/Error'
  Error:
    type: object
    properties:
      title:
        type: string
        description: 'a short, human-readable summary of the problem that SHOULD NOT change from occurrence to occurrence of the problem.'
        example: Invalid Attribute
      detail:
        type: string
        description: a human-readable explanation specific to this occurrence of the problem.
        example: Title must contain at least three characters.
      source:
        type: object
        properties:
          pointer:
            type: string
            example: /data/attributes/title
  LDPContainer:
    required:
      - containerID
      - name
      - URI
      - resources
    properties:
      containerID:
        type: string
      name:
        type: string
      URI:
        type: string
      resources:
        type: array
        items:
          $ref: '#/definitions/Resource'
  Resource:
    required:
      - "@graph"
      - "@id"
      - "@context"
    properties:
      "@graph":
        type: array
        items:
          type: object
          allOf:
            - $ref: "#/definitions/ResourceInfo"
      "@id":
        type: string
        format: uri
      "@context":
        $ref: "#/definitions/ResourceContext"
  ResourceInfo:
    required:
      - "@id"
      - "@type"
      - label
      - resource
    properties:
      "@id":
        type: string
        format: uri
      "@type":
        type: string
        format: uri
      label:
        type: string
      resource:
        type: string
        format: uri
  ResourceContext:
    required:
      - "@id"
      - "@type"
      - label
    properties:
      "@id":
        type: string
        format: uri
      "@type":
        type: string
        format: uri
      label:
        $ref: "#/definitions/variable"
  variable:
    type: object
    required:
      - "@id"
      - "@type"
    properties:
      "@id":
        type: string
        format: uri
      "@type":
        type: string
        format: uri
